<link rel="import" href="../elements.html">
<link rel="import" href="../globals-behavior/globals-behavior.html">
<dom-module id="my-explore">
    <style>
    :host {
        display: inline-table;
    }
    
    #candidateCard {
        display: inline-flex;
        padding: 10px 20px 10px 20px;
    }
    
    #fab {
        position: fixed;
        bottom: 16px;
        right: 16px;
        color: white;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
    }
    
    #trending {
        display: block;
        background-color: white;
        width: 80px;
        /*height: 50px;*/
        text-align: center;
        font-style: italic;
        font-size: 15px;
        border-radius: 5px;
    }
    
    @media (width: 720px) {
        #candidateCard {
            width: 80vw;
        }
    }
    </style>
    <template>
        <paper-card elevation="3" id="trending">Trending</paper-card>
        <img src="" id="testImg">
        <template is="dom-repeat" items="{{items}}">
            <candidate-card id="candidateCard" name="{{item}}" party="Republican" education="BS, Harvard University" title="President (D-NA) Challenger" image="https://upload.wikimedia.org/wikipedia/commons/d/de/Bernie_Sanders.jpg"></candidate-card>
        </template>
        <paper-fab icon="camera-alt" id="fab" on-click="_doMagic"></paper-fab>
    </template>
    <script>
    (function() {
        Polymer({
            is: 'my-explore',

            properties: {
                greeting: {
                    type: String,
                    value: 'Welcome!',
                    notify: true
                }
            },
            ready: function() {
                this.items = [
                    'Bernie Sanders',
                    'Carly Fiorina',
                    'Ted Cruz',
                    'Donald McDonald',
                    'Bobby Jindal',
                    'Joe Biden',
                    'Jeb Bush',
                    'Hillary Clinton',
                    'John Doe',
                    'Not Obama'
                ];
            },
            _doMagic: function() {
                navigator.camera.getPicture(onSuccess, onFail, {
                    destinationType: Camera.DestinationType.DATA_URL
                });

                function onSuccess(imageURI) {
                    function myDetectCallback(response) {
                        var json = JSON.parse(response.responseText);
                        if (json.images[0].transaction.status == 'success')
                            alert(json.images[0].transaction.subject);
                        else
                            alert('Person not recognized. Please try again :c');
                    }
                    base64_data = imageURI;
                    gallery_id = 'politica';
                    var options = {
                        "threshold": 0.65
                    };
                    kairos.recognize(base64_data, gallery_id, myDetectCallback, options);
                }

                function onFail(message) {
                    alert('Failed because: ' + message);
                }
            }
        });
    })();
    </script>
</dom-module>
