<link rel="import" href="../elements.html">
<link rel="import" href="../globals-behavior/globals-behavior.html">
<dom-module id="my-discover">
    <style>
    :host {
        display: block;
    }
    
    news-card {
        margin: 15px 4.5vw;
    }
    
    @media (max-width: 720px) {
        #newsCard {
            width: 80vw;
        }
    }
    </style>
    <template>
        <iron-media-query query="(max-width: 720px)" query-matches="{{isPhone}}"></iron-media-query>
        <firebase-collection id="newsfb" data="{{news}}" location="https://politeianews.firebaseio.com/top_stories" limit-to-first="5"></firebase-collection>
        <firebase-collection id="educationfb" data="{{edunews}}" location="https://politeianews.firebaseio.com/education" limit-to-first="5"></firebase-collection>
        <firebase-collection id="climatefb" data="{{climatenews}}" location="https://politeianews.firebaseio.com/climate_change" limit-to-first="5"></firebase-collection>
        <firebase-collection id="foreignfb" data="{{foreignnews}}" location="https://politeianews.firebaseio.com/foreign_policy" limit-to-first="5"></firebase-collection>
        <template is="dom-if" if="{{isPhone}}">
            <template is="dom-repeat" items="[[news]]">
                <news-card heading="[[item.title]]" content="[[item.sentences]]" link="[[item.link]]" image="[[item.image]]" id="newsCard" topic="Top Stories" on-click="_expandCard"></news-card>
            </template>
            <template is="dom-repeat" items="[[edunews]]">
                <news-card heading="[[item.title]]" content="[[item.sentences]]" link="[[item.link]]" image="[[item.image]]" id="newsCard" topic="Education"></news-card>
            </template>
            <template is="dom-repeat" items="[[climatenews]]">
                <news-card heading="[[item.title]]" content="[[item.sentences]]" link="[[item.link]]" image="[[item.image]]" id="newsCard" topic="Climate Change"></news-card>
            </template>
            <template is="dom-repeat" items="[[foreignnews]]">
                <news-card heading="[[item.title]]" content="[[item.sentences]]" link="[[item.link]]" image="[[item.image]]" id="newsCard" topic="Foreign Policy"></news-card>
            </template>
        </template>
        <template is="dom-if" if="{{!isPhone}}">
            <div class="horizontal layout">
                <div class="vertical layout flex">
                    <template is="dom-repeat" items="[[news]]">
                        <news-card heading="[[item.title]]" content="[[item.sentences]]" link="[[item.link]]" image="[[item.image]]" id="newsCard" topic="Top Stories" on-click="_expandCard"></news-card>
                    </template>
                    <template is="dom-repeat" items="[[edunews]]">
                        <news-card heading="[[item.title]]" content="[[item.sentences]]" link="[[item.link]]" image="[[item.image]]" id="newsCard" topic="Education"></news-card>
                    </template>
                </div>
                <div class="vertical layout flex">
                    <template is="dom-repeat" items="[[climatenews]]">
                        <news-card heading="[[item.title]]" content="[[item.sentences]]" link="[[item.link]]" image="[[item.image]]" id="newsCard" topic="Climate Change"></news-card>
                    </template>
                    <template is="dom-repeat" items="[[foreignnews]]">
                        <news-card heading="[[item.title]]" content="[[item.sentences]]" link="[[item.link]]" image="[[item.image]]" id="newsCard" topic="Foreign Policy"></news-card>
                    </template>
                </div>
            </div>
        </template>
        <paper-button raised style="display: block" on-click="_loadMore"><i>LOAD MORE</i></paper-button>
    </template>
    <script>
    (function() {
        Polymer({
            is: 'my-discover',
            behaviors: [MyBehaviors.GlobalsBehavior],
            _loadMore: function() {
                this.$.newsfb.limitToFirst += 5;
                this.$.educationfb.limitToFirst += 5;
                this.$.climatefb.limitToFirst += 5;
                this.$.foreignfb.limitToFirst += 5;
            },
            _expandCard: function() {
                console.dir(this.$.newsCard);
            }
        });
    })();
    </script>
</dom-module>
